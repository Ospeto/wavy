<p align="center">
  <img src="https://img.shields.io/badge/Node.js-18+-339933?style=for-the-badge&logo=node.js&logoColor=white" alt="Node.js">
  <img src="https://img.shields.io/badge/TypeScript-5.x-3178C6?style=for-the-badge&logo=typescript&logoColor=white" alt="TypeScript">
  <img src="https://img.shields.io/badge/Docker-Ready-2496ED?style=for-the-badge&logo=docker&logoColor=white" alt="Docker">
  <img src="https://img.shields.io/badge/Gemini%20AI-2.0%20Flash-4285F4?style=for-the-badge&logo=google&logoColor=white" alt="Gemini AI">
</p>

<h1 align="center">ğŸŒŠ Wavy VPN Bot</h1>

<p align="center">
  <strong>Automated Telegram VPN Sales with AI-Powered Fraud Detection</strong>
</p>

<p align="center">
  A production-ready Telegram bot that automates VPN subscription sales with instant AI verification of payment screenshots and automatic key generation via Remnawave.
</p>

---

## âœ¨ Features

| Feature | Description |
|---------|-------------|
| ğŸ¤– **Telegram Bot** | Smooth conversational experience built with Grammy |
| ğŸ§  **AI Fraud Detection** | Google Gemini 2.0 Flash analyzes payment screenshots in <3 seconds |
| ğŸ”‘ **Instant Key Generation** | Automatic subscription URL generation via Remnawave API |
| ğŸŒ **Multi-Language** | Full English and Myanmar (Burmese) support |
| ğŸŸï¸ **Promo Codes** | Plan-specific discounts with usage limits and expiration |
| ğŸ’³ **Multiple Payment Methods** | KBZPay, Wave Money, and Aya Pay integration |
| ğŸ“Š **Admin Dashboard** | Transaction stats, recent activity, and promo management |
| ğŸ›¡ï¸ **Anti-Spam Protection** | Rate limiting to prevent abuse |
| âš¡ **High Performance** | In-memory caching, retry logic with exponential backoff |

---

## ğŸ“¦ Subscription Plans

| Plan | Duration | Data | Price (MMK) |
|------|----------|------|-------------|
| 1 Month Lite | 30 Days | 100 GB | 5,000 |
| 1 Month Unlimited | 30 Days | â™¾ï¸ Unlimited | 10,000 |
| 3 Months Lite | 90 Days | 300 GB | 13,500 |
| 3 Months Unlimited | 90 Days | â™¾ï¸ Unlimited | 27,000 |
| 6 Months Lite | 180 Days | 600 GB | 25,000 |
| 6 Months Unlimited | 180 Days | â™¾ï¸ Unlimited | 50,000 |

---

## ğŸ“± User Guide | á€¡á€á€¯á€¶á€¸á€•á€¼á€¯á€”á€Šá€ºá€¸ á€œá€™á€ºá€¸á€Šá€½á€¾á€”á€º

<details>
<summary><strong>ğŸ¤– For Android</strong></summary>

### English

1. **Install the App**: Download [Happ Proxy](https://play.google.com/store/apps/details?id=com.happproxy&hl=en) from Play Store or use the provided link.

2. **Add Subscription**: Click the "Add Subscription" button on the link page. Servers will be automatically imported into the app.

3. **Alternative Method**: If the button doesn't work, copy the subscription URL and tap "Import from Clipboard" inside the Happ App.

4. **Connect**: Select your preferred server and tap Connect. You're ready to browse securely!

---

### á€™á€¼á€”á€ºá€™á€¬

1. **App á€‘á€Šá€·á€ºá€á€½á€„á€ºá€¸á€á€¼á€„á€ºá€¸**: á€•á€±á€¸á€‘á€¬á€¸á€á€±á€¬ Link á€á€­á€¯á€·á€™á€Ÿá€¯á€á€º Play Store á€™á€¾ [Happ Proxy](https://play.google.com/store/apps/details?id=com.happproxy&hl=en) App á€€á€­á€¯ Install á€œá€¯á€•á€ºá€•á€«á‹

2. **Subscription á€‘á€Šá€·á€ºá€á€¼á€„á€ºá€¸**: Link á€…á€¬á€™á€»á€€á€ºá€”á€¾á€¬á€›á€¾á€­ "Add Subscription" á€á€œá€¯á€á€ºá€€á€­á€¯ á€”á€¾á€­á€•á€ºá€•á€«á‹ App á€‘á€²á€á€­á€¯á€· Server á€™á€»á€¬á€¸ á€¡á€œá€­á€¯á€¡á€œá€»á€±á€¬á€€á€º á€›á€±á€¬á€€á€ºá€á€½á€¬á€¸á€•á€«á€™á€Šá€ºá‹

3. **á€¡á€á€¼á€¬á€¸á€”á€Šá€ºá€¸á€œá€™á€ºá€¸**: á€”á€¾á€­á€•á€ºá€œá€­á€¯á€·á€™á€›á€•á€«á€€ Link á€€á€­á€¯ Copy á€šá€°á€•á€¼á€®á€¸ Happ App á€‘á€²á€›á€¾á€­ "Import from Clipboard" á€€á€­á€¯ á€”á€¾á€­á€•á€ºá€•á€«á‹

4. **á€á€»á€­á€á€ºá€†á€€á€ºá€á€¼á€„á€ºá€¸**: á€€á€¼á€­á€¯á€€á€ºá€”á€¾á€…á€ºá€á€€á€ºá€›á€¬ Server á€á€…á€ºá€á€¯á€›á€½á€±á€¸á€•á€¼á€®á€¸ Connect á€œá€¯á€•á€ºá€€á€¬ á€…á€á€„á€ºá€¡á€á€¯á€¶á€¸á€•á€¼á€¯á€”á€­á€¯á€„á€ºá€•á€«á€•á€¼á€®á‹

</details>

<details>
<summary><strong>ğŸ For iOS (iPhone/iPad)</strong></summary>

### English

1. **Install the App**: Search for "Happ Proxy" in the [App Store](https://apps.apple.com/sg/app/happ-proxy-utility/id6504287215) and download it.

2. **Open Subscription Link**: Click the subscription URL provided by the bot.

3. **Copy the Link**: Tap the chain icon (ğŸ”—) next to the Telegram logo, then tap "Copy Link" below the QR code.

4. **Import to App**: Open Happ Proxy app and tap "Import from Clipboard".

5. **Connect**: Tap Connect and enjoy secure browsing!

---

### á€™á€¼á€”á€ºá€™á€¬

1. **App á€‘á€Šá€·á€ºá€á€½á€„á€ºá€¸á€á€¼á€„á€ºá€¸**: [App Store](https://apps.apple.com/sg/app/happ-proxy-utility/id6504287215) á€á€½á€„á€º "Happ Proxy" á€€á€­á€¯ á€›á€¾á€¬á€•á€¼á€®á€¸ download á€†á€½á€²á€•á€«á‹

2. **Link á€–á€½á€„á€·á€ºá€á€¼á€„á€ºá€¸**: Bot á€™á€¾ á€•á€±á€¸á€‘á€¬á€¸á€á€±á€¬ subscription link á€€á€­á€¯ click á€”á€¾á€­á€•á€ºá€•á€«á‹

3. **Link á€€á€°á€¸á€á€¼á€„á€ºá€¸**: Telegram logo á€˜á€±á€¸á€€ chain á€•á€¯á€¶á€œá€±á€¸ (ğŸ”—) á€€á€­á€¯á€”á€¾á€­á€•á€ºá€•á€¼á€®á€¸ QR code á€¡á€±á€¬á€€á€ºá€€ "Copy Link" á€–á€¼á€„á€·á€º link á€€á€°á€¸á€•á€«á‹

4. **App á€á€­á€¯á€· á€‘á€Šá€·á€ºá€á€½á€„á€ºá€¸á€á€¼á€„á€ºá€¸**: Happ Proxy app á€€á€­á€¯á€á€„á€ºá€•á€¼á€®á€¸ "Import from Clipboard" á€”á€¾á€­á€•á€ºá€•á€«á‹

5. **á€á€»á€­á€á€ºá€†á€€á€ºá€á€¼á€„á€ºá€¸**: Connect á€”á€¾á€­á€•á€ºá€•á€¼á€®á€¸á€á€¯á€¶á€¸á€œá€­á€¯á€·á€›á€•á€«á€•á€¼á€®á‹

</details>

> ğŸ’¬ **á€¡á€†á€„á€ºá€™á€•á€¼á€±á€›á€„á€º á€•á€¼á€±á€¬á€•á€«á€—á€»á‹ Video guide á€•á€­á€¯á€·á€•á€±á€¸á€•á€«á€™á€šá€ºá‹**
>
> If you need help, contact support for a video guide.

---

## ğŸš€ Quick Start

### Prerequisites

- Docker & Docker Compose installed
- Telegram Bot Token from [@BotFather](https://t.me/BotFather)
- [Google Gemini API Key](https://aistudio.google.com/apikey)
- Remnawave Panel with API access

### Installation

```bash
# Clone the repository
git clone https://github.com/Ospeto/wavy.git
cd wavy

# Create environment file
cp .env.example .env

# Edit with your credentials
nano .env

# Start the bot
docker-compose up -d --build
```

### Environment Variables

Create a `.env` file in the root directory:

```env
# Telegram
TELEGRAM_BOT_TOKEN=your_bot_token_here

# Remnawave Panel
REMNAWAVE_API_URL=https://your-panel.example.com
REMNAWAVE_API_KEY=your_remnawave_api_key

# Google Gemini AI
GEMINI_API_KEY=your_gemini_api_key

# Admin Access (comma-separated Telegram User IDs)
ADMIN_USER_IDS=123456789,987654321
```

---

## ğŸ¯ How It Works

```mermaid
flowchart LR
    A[ğŸ‘¤ User] -->|/start| B[ğŸ¤– Bot]
    B -->|Select Plan| C[ğŸ’³ Choose Payment]
    C -->|Upload Screenshot| D[ğŸ§  Gemini AI]
    D -->|Valid| E[ğŸ”‘ Generate Key]
    D -->|Invalid| F[âŒ Rejection + Reason]
    E -->|Remnawave API| G[âœ… Subscription URL]
```

1. **User starts** the bot and selects a subscription plan
2. **Chooses payment method** (KBZPay, Wave, Aya)
3. **Uploads payment screenshot** after making the transfer
4. **Gemini AI verifies** the screenshot in <3 seconds
5. **Key is generated** automatically via Remnawave if valid

---

## ğŸ›¡ï¸ Fraud Detection

The AI verification system performs comprehensive checks:

| Check | Description |
|-------|-------------|
| ğŸ“± **App Matching** | Rejects if screenshot app doesn't match selected payment method |
| ğŸ‘¤ **Recipient Validation** | Verifies payment was sent to "Moe Kyaw Aung" ending in 2220 |
| ğŸ’° **Amount Verification** | Confirms exact expected amount was paid |
| ğŸ”’ **Status Check** | Must show "Success" or "á€„á€½á€±á€œá€½á€¾á€²á€•á€¼á€®á€¸á€•á€«á€•á€¼á€®" |
| ğŸ†” **Transaction ID** | Extracts and validates unique transaction ID |
| ğŸ”„ **Duplicate Prevention** | Checks if transaction ID was already used |
| ğŸ–¼ï¸ **Image Integrity** | Detects digital manipulation, font mismatches, pixelation |
| âš ï¸ **Keyword Blocking** | Rejects if "VPN" appears in payment notes |

---

## ğŸ‘¨â€ğŸ’¼ Admin Commands

| Command | Description |
|---------|-------------|
| `/admin` | System stats and transaction summary |
| `/admin_tx` | View last 10 transactions with details |
| `/addpromo <code> <discount%> <limit> <days> [plan_id]` | Create a promo code |
| `/admin_plans` | List all plan IDs for promo code targeting |

### Creating Promo Codes

```bash
# 20% off on all plans, 50 uses, valid for 7 days
/addpromo SAVE20 20 50 7

# 100% off (free) for 1-month unlimited only, 10 uses, 3 days
/addpromo FREEMONTH 100 10 3 1m-unlimited
```

---

## ğŸ“± User Commands

| Command | Description |
|---------|-------------|
| `/start` | Begin subscription process |
| `/plans` | View available plans |
| `/help` | Instructions and FAQ |
| `/language` | Switch between English and Myanmar |

---

## ğŸ—ï¸ Project Structure

```
wavy/
â”œâ”€â”€ backend/
â”‚   â””â”€â”€ src/
â”‚       â”œâ”€â”€ bot/
â”‚       â”‚   â”œâ”€â”€ handlers/      # Command and callback handlers
â”‚       â”‚   â”œâ”€â”€ constants.ts   # Plans and payment methods
â”‚       â”‚   â”œâ”€â”€ translations.ts # EN/MM translations
â”‚       â”‚   â”œâ”€â”€ types.ts       # Shared TypeScript types
â”‚       â”‚   â””â”€â”€ index.ts       # Bot entry point
â”‚       â”œâ”€â”€ config.ts          # Environment configuration
â”‚       â”œâ”€â”€ database.ts        # JSON database with caching
â”‚       â”œâ”€â”€ gemini.ts          # AI verification logic
â”‚       â”œâ”€â”€ httpClient.ts      # HTTP client with error handling
â”‚       â””â”€â”€ remnawave.ts       # Remnawave API integration
â”œâ”€â”€ docker-compose.yml
â”œâ”€â”€ Dockerfile
â””â”€â”€ .env
```

---

## ğŸ”§ Maintenance

### Docker Commands

```bash
# View real-time logs
docker-compose logs -f

# Restart the bot
docker-compose restart

# Rebuild after code changes
docker-compose up -d --build

# Stop the bot
docker-compose down
```

### Database

Transaction data is persisted in a Docker volume (`wavy-data`). To backup:

```bash
docker cp wavy-bot:/app/data/transactions.json ./backup.json
```

---

## ğŸ“Š Resource Requirements

| Resource | Minimum | Recommended |
|----------|---------|-------------|
| **CPU** | 0.5 Core | 1 Core |
| **RAM** | 512 MB | 1 GB |
| **Storage** | 2 GB | 5 GB |
| **OS** | Linux (Ubuntu/Debian) | Docker-compatible |

---

## ğŸ” Security Features

- âœ… Input validation for all admin commands
- âœ… Rate limiting for screenshot uploads
- âœ… Transaction ID uniqueness enforcement
- âœ… Secure API key management via environment variables
- âœ… Admin-only command access control
- âœ… Retry logic with exponential backoff for external APIs

---

## ğŸ“„ License

This project is licensed under the MIT License.

---

<p align="center">
  Made with ğŸŒŠ by <a href="https://github.com/Ospeto">Ospeto</a>
</p>
